code_version: base
data:
  batch_size:
    test: 32
    train: 32
    val: 32
  num_workers:
    test: 4
    train: 4
    val: 4
  preload_to_ram: true
  test_lmdb_path: null
  train_lmdb_path: dataset/toy_small/dataset.lmdb
  train_shuffle: false
  use_pyg: false
  val_lmdb_path: dataset/toy_small/dataset.lmdb
experiment:
  deterministic: true
  name: overfit_10k
  seed: 42
  version: 1.0.0
model:
  flow_model_args:
    activation_checkpointing: false
    attention_impl: flash
    positional_encoding: false
    transformer_depth: 24
    transformer_heads: 12
  flow_process_args:
    compile_model: false
    num_sampling_steps: 50
    synchronize_timesteps: false
    timestep_distribution: exponential
    use_time_reweighting: true
  hidden_dim: 768
  prior_sampler_args:
    ads_coord_mean:
    - 0.007402
    - -0.702398
    - 0.934607
    ads_coord_std:
    - 8.24743
    - 9.035212
    - 9.979235
    coord_std: 1.0
    lognormal_loc:
    - 1.5845935274470484
    - 1.8048289191348783
    - 2.062939587081105
    lognormal_scale:
    - 0.3456883565588731
    - 0.4261945604282258
    - 0.4394933811412375
    prim_slab_coord_mean:
    - 3.298159
    - 4.591314
    - 5.311862
    prim_slab_coord_std:
    - 2.842205
    - 3.540208
    - 4.057026
    prim_virtual_mean:
    - - 0.0
      - 0.0
      - 0.0
    - - 0.0
      - 0.0
      - 0.0
    - - 0.0
      - 0.0
      - 0.0
    prim_virtual_std:
    - - 5.0
      - 5.0
      - 5.0
    - - 5.0
      - 5.0
      - 5.0
    - - 5.0
      - 5.0
      - 5.0
    scaling_factor_mean: 3.42256
    scaling_factor_std: 0.473372
    supercell_mean:
    - - -0.026726
      - 0.07897
      - -0.06539
    - - -0.133529
      - 0.188983
      - -0.132132
    - - -0.013621
      - -0.254989
      - 0.140161
    supercell_std:
    - - 1.7964
      - 1.213596
      - 0.8779
    - - 1.223385
      - 1.383904
      - 1.337392
    - - 1.373271
      - 1.452034
      - 1.045282
    supercell_virtual_mean:
    - - 0.0
      - 0.0
      - 0.0
    - - 0.0
      - 0.0
      - 0.0
    - - 0.0
      - 0.0
      - 0.0
    supercell_virtual_std:
    - - 10.0
      - 10.0
      - 10.0
    - - 10.0
      - 10.0
      - 10.0
    - - 10.0
      - 10.0
      - 10.0
    uniform_eps: 0.1
    uniform_high: 120.0
    uniform_low: 60.0
  use_kernels: false
output_dir: data/catgen/overfit_10kep/base
prediction:
  num_samples: 1
  refine_final: false
  sampling_center_coords: false
  sampling_steps: 50
training:
  accelerator: gpu
  accumulate_grad_batches: 1
  adam_beta1: 0.9
  adam_beta2: 0.999
  ads_coord_loss_weight: 1.0
  check_val_every_n_epoch: 1000
  checkpoint:
    mode: min
    monitor: train/loss/total
    save_last: true
    save_top_k: 3
  devices: 1
  ema_decay: 0.9999
  gradient_clip_algorithm: norm
  gradient_clip_val: 10.0
  limit_train_batches: null
  limit_val_batches: null
  log_every_n_steps: 10
  loss_space: normalized
  loss_type: l2
  lr: 0.0003
  max_epochs: 10000
  num_sanity_val_steps: 0
  optimizer: adamw
  precision: bf16-mixed
  prim_slab_coord_loss_weight: 1.0
  prim_virtual_loss_weight: 1.0
  scaling_factor_loss_weight: 1.0
  scheduler:
    min_lr_ratio: 0.01
    type: cosine_warmup
    warmup_epochs: null
    warmup_steps: 50
  strategy: auto
  supercell_virtual_loss_weight: 1.0
  train_multiplicity: 1
  use_ema: false
  val_check_interval: null
  weight_decay: 0.001
validation:
  adsorption_device: cuda
  adsorption_model: uma-m-1p1
  adsorption_timeout: 100
  compute_adsorption: false
  flow_samples: 1
  log_structures_to_wandb: true
  max_structures_to_log: 5
  num_workers: 4
  sample_every_n_epochs: 1
  sampling_center_coords: false
  sampling_steps: 50
  structure_matcher_args:
    angle_tol: 10.0
    ltol: 0.3
    stol: 0.5
  timeout: 120
wandb:
  enabled: true
  entity: null
  mode: online
  notes: 'Base: no EMA, LR=0.0003'
  project: CatGen
  tags:
  - overfit_10k
  - base
  watch_freq: 100
  watch_gradients: false
